
import { CharMap, TransformType } from '../types';

const createMap = (source: string, target: string): CharMap => {
  const map: CharMap = {};
  const sourceChars = source.split('');
  const targetChars = Array.from(target);
  sourceChars.forEach((char, index) => {
    if (targetChars[index]) map[char] = targetChars[index];
  });
  return map;
};

const LOWER = 'abcdefghijklmnopqrstuvwxyz√¶√∏√•';
const UPPER = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ√Ü√ò√Ö';
const DIGITS = '0123456789';
const NORMAL = LOWER + UPPER + DIGITS;

const MAPS: Record<TransformType, CharMap> = {
  [TransformType.BOLD_SANS]: createMap(NORMAL, 'ùóÆùóØùó∞ùó±ùó≤ùó≥ùó¥ùóµùó∂ùó∑ùó∏ùóπùó∫ùóªùóºùóΩùóæùóøùòÄùòÅùòÇùòÉùòÑùòÖùòÜùòá√¶√∏√•ùóîùóïùóñùóóùóòùóôùóöùóõùóúùóùùóûùóüùó†ùó°ùó¢ùó£ùó§ùó•ùó¶ùóßùó®ùó©ùó™ùó´ùó¨ùó≠√Ü√ò√Öùü¨ùü≠ùüÆùüØùü∞ùü±ùü≤ùü≥ùü¥ùüµ'),
  [TransformType.BOLD_SERIF]: createMap(NORMAL, 'ùêöùêõùêúùêùùêûùêüùê†ùê°ùê¢ùê£ùê§ùê•ùê¶ùêßùê®ùê©ùê™ùê´ùê¨ùê≠ùêÆùêØùê∞ùê±ùê≤ùê≥√¶√∏√•ùêÄùêÅùêÇùêÉùêÑùêÖùêÜùêáùêàùêâùêäùêãùêåùêçùêéùêèùêêùêëùêíùêìùêîùêïùêñùêóùêòùêô√Ü√ò√Öùüéùüèùüêùüëùüíùüìùüîùüïùüñùüó'),
  [TransformType.ITALIC_SANS]: createMap(NORMAL, 'ùò¢ùò£ùò§ùò•ùò¶ùòßùò®ùò©ùò™ùò´ùò¨ùò≠ùòÆùòØùò∞ùò±ùò≤ùò≥ùò¥ùòµùò∂ùò∑ùò∏ùòπùò∫ùòª√¶√∏√•ùòàùòâùòäùòãùòåùòçùòéùòèùòêùòëùòíùòìùòîùòïùòñùòóùòòùòôùòöùòõùòúùòùùòûùòüùò†ùò°√Ü√ò√Ö0123456789'),
  [TransformType.ITALIC_SERIF]: createMap(NORMAL, 'ùëéùëèùëêùëëùëíùëìùëî‚Ñéùëñùëóùëòùëôùëöùëõùëúùëùùëûùëüùë†ùë°ùë¢ùë£ùë§ùë•ùë¶ùëß√¶√∏√•ùê¥ùêµùê∂ùê∑ùê∏ùêπùê∫ùêªùêºùêΩùêæùêøùëÄùëÅùëÇùëÉùëÑùëÖùëÜùëáùëàùëâùëäùëãùëåùëç√Ü√ò√Ö0123456789'),
  [TransformType.BOLD_ITALIC_SANS]: createMap(NORMAL, 'ùôñùôóùôòùôôùôöùôõùôúùôùùôûùôüùô†ùô°ùô¢ùô£ùô§ùô•ùô¶ùôßùô®ùô©ùô™ùô´ùô¨ùô≠ùôÆùôØ√¶√∏√•ùòºùòΩùòæùòøùôÄùôÅùôÇùôÉùôÑùôÖùôÜùôáùôàùôâùôäùôãùôåùôçùôéùôèùôêùôëùôíùôìùôîùôï√Ü√ò√Ö0123456789'),
  [TransformType.BOLD_ITALIC_SERIF]: createMap(NORMAL, 'ùíÇùíÉùíÑùíÖùíÜùíáùíàùíâùíäùíãùíåùíçùíéùíèùíêùíëùííùíìùíîùíïùíñùíóùíòùíôùíöùíõ√¶√∏√•ùë®ùë©ùë™ùë´ùë¨ùë≠ùëÆùëØùë∞ùë±ùë≤ùë≥ùë¥ùëµùë∂ùë∑ùë∏ùëπùë∫ùëªùëºùëΩùëæùëøùíÄùíÅ√Ü√ò√Ö0123456789'),
  [TransformType.MONOSPACE]: createMap(NORMAL, 'ùöäùöãùöåùöçùöéùöèùöêùöëùöíùöìùöîùöïùöñùöóùöòùöôùööùöõùöúùöùùöûùöüùö†ùö°ùö¢ùö£√¶√∏√•ùô∞ùô±ùô≤ùô≥ùô¥ùôµùô∂ùô∑ùô∏ùôπùô∫ùôªùôºùôΩùôæùôøùöÄùöÅùöÇùöÉùöÑùöÖùöÜùöáùöàùöâ√Ü√ò√Öùü∂ùü∑ùü∏ùüπùü∫ùüªùüºùüΩùüæùüø'),
  [TransformType.SCRIPT]: createMap(NORMAL, 'ùí∂ùí∑ùí∏ùíπùëíùíªùëîùíΩùíæùíøùìÄùìÅùìÇùìÉùëúùìÖùìÜùìáùìàùìâùìäùìãùìåùìçùìéùìè√¶√∏√•ùíúùêµùíûùíüùê∏ùêπùí¢ùêªùêºùí•ùí¶ùêøùëÄùí©ùí™ùí´ùí¨ùëÖùíÆùíØùí∞ùí±ùí≤ùí≥ùí¥ùíµ√Ü√ò√Ö0123456789'),
  [TransformType.BOLD_SCRIPT]: createMap(NORMAL, 'ùì™ùì´ùì¨ùì≠ùìÆùìØùì∞ùì±ùì≤ùì≥ùì¥ùìµùì∂ùì∑ùì∏ùìπùì∫ùìªùìºùìΩùìæùìøùîÄùîÅùîÇùîÉ√¶√∏√•ùìêùìëùìíùììùìîùìïùìñùìóùìòùìôùìöùìõùìúùìùùìûùìüùì†ùì°ùì¢ùì£ùì§ùì•ùì¶ùìßùì®ùì©√Ü√ò√Ö0123456789'),
  [TransformType.FRAKTUR]: createMap(NORMAL, 'ùîûùîüùî†ùî°ùî¢ùî£ùî§ùî•ùî¶ùîßùî®ùî©ùî™ùî´ùî¨ùî≠ùîÆùîØùî∞ùî±ùî≤ùî≥ùî¥ùîµùî∂ùî∑√¶√∏√•ùîÑùîÖ‚Ñ≠ùîáùîàùîâùîä‚Ñå‚Ñëùîçùîéùîèùîêùîëùîíùîìùîî‚Ñúùîñùîóùîòùîôùîöùîõùîú‚Ñ®√Ü√ò√Ö0123456789'),
  [TransformType.BOLD_FRAKTUR]: createMap(NORMAL, 'ùñÜùñáùñàùñâùñäùñãùñåùñçùñéùñèùñêùñëùñíùñìùñîùñïùññùñóùñòùñôùñöùñõùñúùñùùñûùñü√¶√∏√•ùï¨ùï≠ùïÆùïØùï∞ùï±ùï≤ùï≥ùï¥ùïµùï∂ùï∑ùï∏ùïπùï∫ùïªùïºùïΩùïæùïøùñÄùñÅùñÇùñÉùñÑùñÖ√Ü√ò√Ö0123456789'),
  [TransformType.DOUBLE_STRUCK]: createMap(NORMAL, 'ùïíùïìùïîùïïùïñùïóùïòùïôùïöùïõùïúùïùùïûùïüùï†ùï°ùï¢ùï£ùï§ùï•ùï¶ùïßùï®ùï©ùï™ùï´√¶√∏√•ùî∏ùîπ‚ÑÇùîªùîºùîΩùîæ‚ÑçùïÄùïõùïÇùïÉùïÑ‚ÑïùïÜ‚Ñô‚Ñö‚Ñùùïäùïãùïåùïçùïéùïèùïê‚Ñ§√Ü√ò√Ö0123456789'),
  [TransformType.BUBBLE]: createMap(NORMAL, '‚ìê‚ìë‚ìí‚ìì‚ìî‚ìï‚ìñ‚ìó‚ìò‚ìô‚ìö‚ìõ‚ìú‚ìù‚ìû‚ìü‚ì†‚ì°‚ì¢‚ì£‚ì§‚ì•‚ì¶‚ìß‚ì®‚ì©√¶√∏√•‚í∂‚í∑‚í∏‚íπ‚í∫‚íª‚íº‚íΩ‚íæ‚íø‚ìÄ‚ìÅ‚ìÇ‚ìÉ‚ìÑ‚ìÖ‚ìÜ‚ìá‚ìà‚ìâ‚ìä‚ìã‚ìå‚ìç‚ìé‚ìè√Ü√ò√Ö0123456789'),
  [TransformType.BUBBLE_FILLED]: createMap(NORMAL, 'üÖêüÖëüÖíüÖìüÖîüÖïüÖñüÖóüÖòüÖôüÖöüÖõüÖúüÖùüÖûüÖüüÖ†üÖ°üÖ¢üÖ£üÖ§üÖ•üÖ¶üÖßüÖ®üÖ©√¶√∏√•üÖêüÖëüÖíüÖìüÖîüÖïüÖñüÖóüÖòüÖôüÖöüÖõüÖúüÖùüÖûüÖüüÖ†üÖ°üÖ¢üÖ£üÖ§üÖ•üÖ¶üÖßüÖ®üÖ©√Ü√ò√Ö‚ìø‚ù∂‚ù∑‚ù∏‚ùπ‚ù∫‚ùª‚ùº‚ùΩ‚ùæ'),
  [TransformType.STRIKETHROUGH]: {},
  [TransformType.UNDERLINE]: {},
  [TransformType.SQUARE]: createMap(NORMAL, 'üÑ∞üÑ±üÑ≤üÑ≥üÑ¥üÑµüÑ∂üÑ∑üÑ∏üÑπüÑ∫üÑªüÑºüÑΩüÑæüÑøüÖÄüÖÅüÖÇüÖÉüÖÑüÖÖüÖÜüÖáüÖàüÖâ√¶√∏√•üÑ∞üÑ±üÑ≤üÑ≥üÑ¥üÑµüÑ∂üÑ∑üÑ∏üÑπüÑ∫üÑªüÑºüÑΩüÑæüÑøüÖÄüÖÅüÖÇüÖÉüÖÑüÖÖüÖÜüÖáüÖàüÖâ√Ü√ò√Ö0123456789'),
  [TransformType.SQUARE_FILLED]: createMap(NORMAL, 'üÖ∞üÖ±üÖ≤üÖ≥üÖ¥üÖµüÖ∂üÖ∑üÖ∏üÖπüÖ∫üÖªüÖºüÖΩüÖæüÖøüÜÄüÜÅüÜÇüÜÉüÜÑüÜÖüÜÜüÜáüÜàüÜâ√¶√∏√•üÖ∞üÖ±üÖ≤üÖ≥üÖ¥üÖµüÖ∂üÖ∑üÖ∏üÖπüÖ∫üÖªüÖºüÖΩüÖæüÖøüÜÄüÜÅüÜÇüÜÉüÜÑüÜÖüÜÜüÜáüÜàüÜâ√Ü√ò√Ö0123456789'),
};

export const getMappedChar = (char: string, type: TransformType): string => {
  if (type === TransformType.STRIKETHROUGH) return char + '\u0336';
  if (type === TransformType.UNDERLINE) return char + '\u0332';
  const map = MAPS[type];
  return map?.[char] || char;
};

export const transformText = (text: string, type: TransformType): string => {
  return Array.from(text).map(char => getMappedChar(char, type)).join('');
};
